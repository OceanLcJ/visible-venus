---
import type { CollectionEntry } from "astro:content";
import IconEdit from "@/assets/icons/IconEdit.svg";
import { SITE, LOCALE_CONFIG } from "@/config";
import type { SupportedLocale } from "@/config";

export interface Props {
  hideEditPost?: CollectionEntry<"blog" | "blog-en" | "blog-zh">["data"]["hideEditPost"];
  class?: string;
  post: CollectionEntry<"blog" | "blog-en" | "blog-zh">;
  locale?: SupportedLocale;
}

const { hideEditPost, post, locale = "en", class: className = "" } = Astro.props;

const href = `${SITE.editPost.url}${post.filePath}`;
const showEditPost =
  SITE.editPost.enabled && !hideEditPost && href.trim() !== "";

// Get localized edit text
const editText = LOCALE_CONFIG[locale]?.editPost?.text || SITE.editPost.text;
---

{
  showEditPost && (
    <div class:list={["opacity-80", className]}>
      <span aria-hidden="true" class="max-sm:hidden">
        |
      </span>
      <a
        class="space-x-1.5 hover:opacity-75"
        href={href}
        rel="noopener noreferrer"
        target="_blank"
      >
        <IconEdit class="inline-block size-6" />
        <span class="italic max-sm:text-sm sm:inline">
          {editText}
        </span>
      </a>
    </div>
  )
}
